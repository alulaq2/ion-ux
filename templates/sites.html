<div class="select_all">
    <input class="checkAllSites" type="checkbox"/> Select All
</div>
<form id="sitesForm">
<div class="list_sites">
    
        <% _.each(this.collection.models, function(site) { %>
        	<input id="site_item" class="resource_id" data-id="<%= site.attributes._id %>" data-sites="<%= site.attributes.spatial_area_name %>" type="checkbox" name="<%= site.attributes.name %>" /><div class="resourceLink" data-id="<%= site.attributes._id %>">
        	<% if (site.attributes.local_name) { %>
        		<%= site.attributes.local_name %><br/>
            <% } else { %>
    			<%= site.attributes.name %><br/>
            <% }; %>
            </div><br/>
        <% }) %>
</div>
</form>
<script>
    $(function(){
        $(".list_sites .resourceLink").click(function(){
            var resource_id = $(this).attr('data-id');
            var url = "/Observatory/face/"+resource_id+"/";
            IONUX.ROUTER.navigate('');
            IONUX.ROUTER.navigate(url, {trigger:true});
            $('#mapButtonHidden').click();
        });

        $('.list_sites input[type="checkbox"]').each(function(index) {
            $(this).on('click', function(e) {
            var checked_val = $(this).attr('name');
            if ($(this).is(':checked')) {
                numDataTypes++;
                var numFilters = $('.filter-add').length;
                $('.booleanInput').eq(numFilters-1).val(checked_val);
                $('.filter-add').eq(numFilters-1).click();
            }
            else {
                numDataTypes--;
                var inputList = [];
                $('.booleanInput').each(function(item) {
                    inputList.push($(this).val());
                });
                for (var i=0; i<inputList.length; i++) {
                    if ($(this).attr('name') == inputList[i]) {
                        $('.filter-remove').eq(i).click();
                    }
                }
            }
        });
    });
    });
</script>